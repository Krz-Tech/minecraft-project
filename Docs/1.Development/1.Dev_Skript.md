ファイル：`Docs/1.Development/1.Dev_Skript.md`
更新日時：`2025/12/31`

# Skriptコーディング規約
以下は本プロジェクトで使用されるSkriptのコーディング規約です。厳守してください。

## 1. 参照ドキュメント
構文に関するドキュメントを参照する際、必ず以下に提示されたリンクを最優先に使用してください。
* [Skript Documentation](https://docs.skriptlang.org/)
  * [イベント・トリガー | Events](https://docs.skriptlang.org/events.html)
  * [状態確認・条件分岐 | Conditions](https://docs.skriptlang.org/conditions.html)
  * [Sections](https://docs.skriptlang.org/sections.html)
  * [発生させる効果・イベント | Effects](https://docs.skriptlang.org/effects.html)
  * [属性 | Expressions](https://docs.skriptlang.org/expressions.html)
  * [Types](https://docs.skriptlang.org/types.html)
  * [Structures](https://docs.skriptlang.org/structures.html)
  * [Functions](https://docs.skriptlang.org/functions.html)
* [Skript Documentation | Guides](https://docs.skunity.com/guides)
  * [パケット送信 | Packets](https://docs.skunity.com/guides/tutorial/320)
  * [Skript標準GUI | Vanilla GUIs](https://docs.skunity.com/guides/tutorial/8939)
  * [変数 | Variables](https://docs.skunity.com/guides/guide/variables.7)
* [skUnity](https://docs.skunity.com/)

## 2. 命名規則
命名規則は以下の通りに従ってください。
* すべての命名において意味が伝わりやすく短い名前にしてください。
* 変数、関数、モジュール名はcamelCaseを使用してください。

## 3. データの取扱い
### プレイヤー
* プレイヤーは基本UUIDを参照してください。
* 関数にプレイヤーのUUIDを渡す際は必ず`{_p}`で一時変数を使用してください。

### グローバル
* サーバー全体のグローバル変数はわかりやすい名前にしてください。
* Optionsを使用して設定できる場合、積極的に使用してください。(Prefixなど)

## 4. モジュール分割
* 極力モジュール(複数ファイル・ディレクトリ)に分割してください。
* 他の機能で使用可能だと判断した機能や関数はモジュールとして分割し、構造化されたコードにしてください。

## 5. 構文・インデント
* Skriptには様々な構文があるため構文エラーが多発します。無理に解決しようとしないでください。
* 構文が不明な場合、曖昧な場合は必ず[参照ドキュメント](#1-参照ドキュメント)を確認してください。
* インデントは4スペースにしてください。
* ---や===で囲ったブロックコメントなどの補足情報はインデントはしないでください。

## 6. コメント
* コメントは原則日本語で記述してください。
* コメントは関数・コードに記述する際にはそのコードの上段に記述し、必ず改行してください。
* ブロックコメントで補足情報を記述する際、---や===で囲ってください。

## 7. 変数命名パターン
以下の命名パターンに従ってください。
* 一時変数: `{_variableName}`
* プレイヤー固有データ: `{player::%{_p}%::dataName}`
* グローバル設定: `{global::configName}`
* リスト変数: `{list::*}` 形式

### デバッグモード変数
サーバー全体で共通のデバッグモードを使用します。加えて、プレイヤー固有のパラメータなどをリセットする際、デバッグモードが有効でないとリセットできないようにしてください。
* 変数名: `{global::debugMode}`
* 型: Boolean (`true` / `false`)
* 用途: デバッグログ出力の有効化・無効化

デバッグ出力例:
```
if {global::debugMode} is true:
    broadcast "[DEBUG] %{_variable}%"
```

## 8. エラー対応
* 構文エラーが発生した場合、まず[参照ドキュメント](#1-参照ドキュメント)を確認してください。
* デバッグ用ログ出力: `broadcast "[DEBUG] %{_variable}%"` または `send "[DEBUG] %{_variable}%" to console`
* Skriptのリロード: `/sk reload <ファイル名>`
* 無理やり解決しようとせず、原因を特定してから修正してください。

## 9. ファイル構成
プロジェクトのドキュメント構造に沿ったモジュール分割を行ってください。
```
plugins/Skript/scripts/
├── core/           # コア機能・共通関数・グローバル変数初期化
├── system/         # システム関連 (デバッグ、設定管理)
├── battle/         # 戦闘システム (2.Game_Battle対応)
├── economy/        # 経済システム (2.Game_Economy対応)
├── items/          # アイテム定義 (2.Game_Items対応)
│   ├── accessories/
│   ├── consumables/
│   ├── equipments/
│   ├── materials/
│   ├── tools/
│   └── weapons/
├── ux/             # UI・HUD関連 (3.UXOptimization対応)
└── events/         # カスタムイベント
```

## 10. 使用アドオン
本プロジェクトで使用可能なSkriptアドオンは以下の通りです。

### skBee
Minecraft APIへの高度なアクセスを提供するアドオンです。
* [SkriptHub Docs](https://skripthub.net/docs/?addon=SkBee)
* [GitHub Wiki](https://github.com/ShaneBeee/SkBee/wiki)
* [skUnity Docs](https://docs.skunity.com/syntax/search/addon:skbee)

主な機能:
* NBT操作 (アイテム、エンティティ、ブロック)
* ボス/スコアボード操作
* パーティクル・サウンド拡張
* WorldBorder操作
* Structures API

### skript-reflect
Java APIへの直接アクセスを提供するリフレクションアドオンです。
* [GitBook Documentation](https://tpgamesnl.gitbook.io/skript-reflect/)
* [SkriptHub Docs](https://skripthub.net/docs/?addon=skript-reflect)
* [skUnity Docs](https://docs.skunity.com/syntax/search/addon:skript-reflect)

主な機能:
* Java クラス・メソッドへの直接アクセス
* カスタムイベントの作成
* 非同期イベントリスニング

> **注意**: skript-reflectの使用にはJavaの基礎知識が必要です。Skript標準機能やskBeeで実現できる場合はそちらを優先してください。