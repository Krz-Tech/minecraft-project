# UXデザインガイドライン (UX Design Guidelines)

## 概要
プレイヤー体験 (UX) を統一するためのデザイン規約です。
すべてのメッセージ、GUI、視覚効果はこのガイドラインに従って実装してください。

---

## 1. カラーパレット (Color Palette)

Tech/Cyberpunk世界観を表現する統一カラーを使用します。

### プライマリカラー
| 名称 | Minecraftコード | HEX | 用途 |
|------|----------------|-----|------|
| **Cyan (Primary)** | `&b` | `#55FFFF` | システムメッセージ、ハイライト |
| **Dark Aqua** | `&3` | `#00AAAA` | サブタイトル、補足情報 |
| **White** | `&f` | `#FFFFFF` | 通常テキスト |
| **Gray** | `&7` | `#AAAAAA` | 補足、無効状態 |

### アクセントカラー
| 名称 | Minecraftコード | HEX | 用途 |
|------|----------------|-----|------|
| **Green** | `&a` | `#55FF55` | 成功、取得、ポジティブ |
| **Red** | `&c` | `#FF5555` | 警告、失敗、ダメージ |
| **Gold** | `&6` | `#FFAA00` | 重要、レア、通貨 |
| **Light Purple** | `&d` | `#FF55FF` | 特殊、イベント |

### 使用禁止
*   `&0` (黒): 視認性が悪いため使用禁止。
*   `&5` (紫): 魔法を連想させるため使用禁止。

---

## 2. Join / Logout 表示

### ログイン時 (on join)

#### チャットメッセージ
```
&8[&aSYNC&8] &f<プレイヤー名> &7connected
```

#### ブートシーケンスアニメーション
ログイン時、盲目エフェクトで画面を暗転させ、スペクテイターモードによる移動制限下でコンソール起動風のタイトルアニメーションを表示します。

| フェーズ | 表示内容 (Subtitle) | 演出内容 |
|---------|-------------------|---------|
| **Phase 1: System Check** | `SYSTEM CHECK` | 1文字ずつタイプ表示。その後、`Core Unit`, `Generator`, `FCS Module`, `Booster`, `Arms Unit` の [OK] 判定を表示。 |
| **Phase 2: OS Boot** | `BOOT Loading OS...` | プロンプト入力アニメーション。 |
| **Phase 3: Connection** | `SYNC ONLINE` | 接続試行アニメーション。完了時に `Operational` と表示。 |
| **Phase 4: Assembly** | `Code::Playground` (Title) | メインロゴ表示、盲目解除、円状の `END_ROD` パーティクル展開。 |

#### パーティクル演出 (ロード完了時)
*   **種類**: `END_ROD`
*   **配置**: プレイヤーの周囲を円状に 360度展開。
*   **サウンド**: `sfx_login` (コンポジットサウンド) を同時再生。

#### ActionBar (5秒間)
```
&7ランク: &b<ランク> &8| &7所持金: &6<Δコイン>Δ
```

#### Skript実装例 (Core概要)
```skript
function fx_boot_sequence(p: player):
    apply blindness 10 to {_p}
    set gamemode of {_p} to spectator
    set {-sys::boot::%uuid of {_p}%::freeze} to true
    
    # Phase 1: SYSTEM CHECK (タイプアニメーション後半)
    send title "" with subtitle "&8SYSTEM CHECK" to {_p} for 2 seconds
    wait 8 ticks
    send title "" with subtitle "&8> &7Core Unit &a[OK]" to {_p} for 2 seconds
    wait 8 ticks
    # ... 他のユニットチェック ...

    # Phase 4: 完了
    send title "&b&lCode::Playground" with subtitle "&7アセンブリ完了。オペレーター、接続確立。" to {_p} for 3 seconds
    remove blindness from {_p}
    sfx_login({_p})
    
    delete {-sys::boot::%uuid of {_p}%::freeze}
    set gamemode of {_p} to survival
```

---

### ログアウト時 (on quit)

#### チャットメッセージ
```
&8[&cDISC&8] &f<プレイヤー名> &7disconnected
```

*(本人には表示されないため、特別な演出は不要)*

---

## 3. カスタムGUIデザイン

### 基本レイアウト
*   **背景**: 灰色のガラス板 (`GRAY_STAINED_GLASS_PANE`) で埋める。
*   **枠線**: 黒のガラス板 (`BLACK_STAINED_GLASS_PANE`) で外周を囲む。
*   **機能ボタン**: 中央に配置し、Loreに機能説明を記載。

### アイコンルール
| 機能 | アイテム |
|------|---------|
| **閉じる** | バリアブロック (BARRIER) |
| **戻る** | 矢 (ARROW) |
| **確認/決定** | 緑の染料 (LIME_DYE) |
| **キャンセル** | 赤の染料 (RED_DYE) |
| **情報** | 本 (BOOK) |
| **設定** | レッドストーン (REDSTONE) |

### Loreフォーマット
```
&7説明文をここに記載
&7複数行の場合は改行
&r
&8▶ &fクリックで実行
```

*   **最初の行**: 機能説明 (`&7`)
*   **区切り**: 空行 (`&r`)
*   **操作説明**: `&8▶ &f` で始める

---

## 4. チャットメッセージ

### プレフィックス形式
```
[<モジュール名>] <メッセージ>
```

| モジュール | プレフィックス例 |
|-----------|-----------------|
| システム | `&b[System] &f` |
| 経済 | `&6[Economy] &f` |
| プレイグラウンド | `&c[Playground] &f` |
| 生活 | `&a[Life] &f` |
| エラー | `&c[Error] &f` |

### 例
```
&b[System] &fサーバーは10分後に再起動されます。
&6[Economy] &a+500Δ &7を獲得しました。
&c[Playground] &f帰還条件を満たしました。 &8/vanish &7で帰還できます。
```

---

## 5. サウンド (Sounds)

視覚だけでなく聴覚でもフィードバックを提供します。

| イベント | サウンド |
|---------|---------|
| **成功/取得** | `ENTITY_EXPERIENCE_ORB_PICKUP` |
| **エラー/失敗** | `ENTITY_VILLAGER_NO` |
| **GUI開く** | `BLOCK_CHEST_OPEN` |
| **GUI閉じる** | `BLOCK_CHEST_CLOSE` |
| **ボタンクリック** | `UI_BUTTON_CLICK` |
| **警告** | `BLOCK_NOTE_BLOCK_BASS` |
| **レベルアップ** | `ENTITY_PLAYER_LEVELUP` |

### コンポジットサウンド (Composite Sounds)
複数の音源を重ねて、オリジナルの効果音を作成します。
Tech世界観に合った印象的なサウンドを演出します。

| イベント | 構成サウンド | 備考 |
|---------|-------------|------|
| **ログイン** | `BLOCK_BEACON_POWER_SELECT` (pitch:0.5) + `ENTITY_EXPERIENCE_ORB_PICKUP` (pitch:1.2) + `UI_TOAST_CHALLENGE_COMPLETE` (vol:0.5) | 起動＋歓迎感 |
| **帰還成功** | `ENTITY_ENDERMAN_TELEPORT` (pitch:0.5) + `BLOCK_BEACON_ACTIVATE` (pitch:1.5, vol:0.8) + `UI_TOAST_CHALLENGE_COMPLETE` (vol:0.5) | Techワープ演出 |
| **スタッガー発生** | `ENTITY_GENERIC_EXPLODE` (vol:0.6) + `BLOCK_ANVIL_LAND` (pitch:0.5) + `BLOCK_NOTE_BLOCK_BASS` (pitch:0.5) | 重い衝撃感 |
| **レベルアップ** | `ENTITY_PLAYER_LEVELUP` + `ENTITY_FIREWORK_ROCKET_LAUNCH` (vol:0.7) + `BLOCK_BEACON_ACTIVATE` (vol:0.5) | 達成感＋祝福 |
| **死亡** | `ENTITY_WITHER_SPAWN` (pitch:2.0, vol:0.5) + `BLOCK_GLASS_BREAK` + `ENTITY_IRON_GOLEM_DEATH` (pitch:1.5) | システム破壊音 |
| **危険地帯侵入** | `BLOCK_NOTE_BLOCK_BASS` (pitch:0.5) × 3回 + `ENTITY_WARDEN_HEARTBEAT` (vol:0.8) | 警告＋緊張感 |

### 実装例 (Skript)
```skript
function sfx_vanish(p: player):
    play sound "ENTITY_ENDERMAN_TELEPORT" with volume 1 with pitch 0.5 to {_p}
    play sound "BLOCK_BEACON_ACTIVATE" with volume 0.8 with pitch 1.5 to {_p}
    wait 2 ticks
    play sound "UI_TOAST_CHALLENGE_COMPLETE" with volume 0.5 with pitch 1 to {_p}
```

---

## 6. BossBar / ActionBar

### BossBar (常時表示)
プレイグラウンドのみ使用。

*   **色**: `BLUE` (通常) / `RED` (危険地帯)
*   **表示内容**: 帰還条件（残り距離/時間）

```
&f帰還可能まで: &b残り 350m &7/ &b2:30
```

### ActionBar (イベント表示)
ダメージ、回復、状態変化などの即時フィードバックに使用。

```
&c-25 AP (βクラスの攻撃)
&a+50 AP (リペアポッド効果)
```

---

## 7. 3人称視点の強制 (3rd Person Enforcement)

Code::Playgroundはアクション性を重視するため、3人称視点でのプレイを必須とします。

### 実装メカニズム
1.  **頭部パーツの固定**: 全プレイヤーに専用の「頭部装備（Techバイザー等）」を仮想スロットで装備させます。
2.  **リソースパックによる遮蔽**: 
    *   1人称視点時にのみ、画面全体を覆うような巨大なモデル（またはテクスチャ）を指定します。
    *   これにより、1人称では何も見えない状態（視界不良）を意図的に作り出します。
3.  **推奨設定の案内**: 
    *   初回参加時に「F5キーで3人称に切り替えてください」というメッセージをTitleで大きく表示します。

### UX上のメリット
*   **演出の統一**: 全プレイヤーが同じカメラワークで戦うため、戦闘バランスが取りやすくなります。
*   **自キャラの視認**: 装備しているTech Suitの見た目を楽しめるため、コスメティック要素の価値が上がります。

---

## 8. プライベート・デジタルHUD (Private Digital HUD)

最新の **Text Display エンティティ** をパケット送信（Packet-based Entity）することで、特定のプレイヤーだけに表示される独自のHUD演出を行います。

### 活用箇所
*   **ターゲットマーカー**: ロックオンした対象の頭上に表示。
*   **スタッガーゲージ**: 敵の衝撃蓄積状態をリアルタイム表示。
*   **ダメージ数値**: 攻撃ヒット時のポップアップ表示。
*   **ナビゲーション**: 帰還ポイントや目的地の方向・距離表示。

### 技術仕様
*   **個別パケット表示**: `ProtocolLib` を用い、サーバー上の実体なしに `TEXT_DISPLAY` を召喚。他のプレイヤーには一切見えません。
*   **Billboard効果**: プレイヤーの視点に合わせて自動回転し、常に正面を向けます。
*   **動的更新**: パケットのデータ値を書き換えることで、位置・テキスト・カラーを既存の表示のまま変更可能。

---

### 8.1. ダメージインジケーター (Damage Indicators)

攻撃命中時、対象の傍に自分にのみ見えるダメージ数値をポップアップ表示します。

#### 表示ロジック (Cumulative Logic)
短時間に連続してダメージを与えた場合、新しいインジケーターを生成せず、**既存の数値を更新（累積表示）** します。

*   **単発攻撃**: 数値のみを表示 (例: `120`)。
*   **連続攻撃 (コンボ/連射)**: 前回の攻撃から一定時間内（例: 2秒以内）であれば、数値を合算し、直近の差分を併記します。
    *   表示形式: `累積合計 (+追加分)` (例: `480 (+120)`)。
*   **クリティカル/直撃**: 数値を大きく、または色付き（例: 黄色・オレンジ）で強調表示。

#### フェード演出
表示後、数秒かけて上方に浮き上がりつつ、透明度（Opacity）を上げてフェードアウト消去パケットを送信します。

---

## 9. スコアボード・サイドバー (Scoreboard & Sidebar)

プレイヤーの右側に表示されるスコアボードは、Tech Suitの「情報端末」としての役割を持ちます。

### 役割の分離
*   **ロビー**: 準備・ステータス確認。
*   **プレイグラウンド**: 危険管理・リソース監視（インカージョンモード）。

詳細なレイアウトと表示項目については、[Scoreboard_Sidebar_Spec.md](file:///Users/kanaha/Documents/GitHub/minecraft-project/Docs/GameSystem/3.1.Scoreboard_Sidebar_Spec.md) を参照してください。

---

## 10. 戦闘HUD・アクションバー (Combat HUD & Action Bar)

戦闘中のリソース管理と空間把握を支援するための表示系です。

*   **アクションバー**: AP, EN, FCSの状態を統合。
*   **空間HUD**: ターゲットマーカー、ダメージ数値、スタッガーゲージを空間内に投影。

詳細な挙動については、[Combat_HUD_Spec.md](file:///Users/kanaha/Documents/GitHub/minecraft-project/Docs/GameSystem/3.2.Combat_HUD_Spec.md) を参照してください。

---

*最終更新: 2025-12-23*
