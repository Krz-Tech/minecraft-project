# Krz-Tech Minecraft Server Project

> 「次世代のマインクラフトの遊び場へようこそ」

# プロジェクト概要

## > プロジェクトの目的
* 新しいスタイルのMinecraftを作りたい
* DX最適化を主軸に動いたらどうなるのか試してみたい
  * クラウド開発環境を使用したMinecraftサーバー開発
  * セルフホスト型のツールの実証検証
  * Cloudflare, Kubernetes, Proxmox等サーバー・ネットワーク系技術を使用したい

## > ゲーム概要
* Minecraft Java Edition (1.21.4)
  * 統合版対応予定なし
* 3人称視点を基本的に使用、一部シーンで例外的に1人称を使用することができる。
* 生活鯖＋レベル上げ鯖
  * 生活鯖要素では「ハウジング・他プレイヤーとの交流」
  * レベル上げ鯖要素ではその名の通り「レベル上げ」
  * 戦闘、購入不可能なアイテムの入手は「プレイグラウンド」で行う。

## > その他概要
* **UX (User Experience)の最適化**
  * 生活・戦闘・クラフト等**Minecraftの醍醐味ではあるが難しいと感じる人もいるかもしれない要素**を簡略化する
    * 特に**戦闘体験を簡単かつ楽しく**したい。
* **DX (Developer Experience)の最適化**
  * Skriptを極力使用し開発を楽にする
    * Javaだとコンパイルやサーバーの再起動等必要であるが、Skriptであれば動的な開発が可能
    * 機能レベルに応じてJava, Kotlinの使用も検討
* Coderを使用した**クラウド開発環境**で**セキュアかつ快適な開発環境提供**
  * テンプレートからワークスペースを作成するだけですぐに開発可能な環境に
    * テンプレート内部で開発サーバーを稼働させ、機能テストを隔離環境で行える
  * Linux系デスクトップ環境をVNCで提供することも可能

## > 各項目詳細
### ゲーム
#### ゲーム：世界観
* バニラの従来のMinecraftを保ちつつ、テクノロジーを感じる要素を含めたい
* リソースパック・BGMを導入してより楽しめるようにしたい
#### ゲーム：ゲームシステム共通
* 体力・防御力・攻撃系・コイン・経験値系のステータスがある
  * 体力はバニラの20が基準
    * アイテム・装備・エフェクトの効果で上昇・減少する
  * 防御力はバニラ仕様ではなくステータスとして存在
  * 攻撃系（攻撃力・会心率・会心ダメージ）がステータスとして存在
    * 装備によって変化する
  * 経験値系（ランク経験値、各要素経験値）が存在
    * 詳細は下部に記載 ([#ランク・レベル上げ要素](#ランクレベル上げ要素))
#### ゲーム：プレイグラウンド
* Escape from Tarkovで採用されているようなスタイル
* プレイグラウンドという全プレイヤー共通のワールドのランダムな座標にスポーン
  * スポーン地点から指定されたブロック移動するとコマンド・アイテムを使用して生活ワールドに帰還することができる
  * 指定時間・指定距離移動で帰還可能になるまでプレイグラウンドにスポーンする敵と戦いながら生存し、アイテムを収集する
  * プレイグラウンドで死亡するとランク経験値が減少してしまう
    * ランク経験値は減少するがランク自体は下がらない。
    * コイン・経験値・アイテムはそのまま。何度でも挑戦しよう。
* 挑戦するのに必要な物資は事前にコインを使用して購入したり、収集したアイテムを使用してクラフト
  * プレイグラウンド上ではブロックの設置破壊は自由に可能
    * 収集したバニラアイテムは帰還時にコインに変換される
    * 収集した独自アイテムはそのままで今後のクラフトや交易に使用できる
#### ゲーム：生活鯖要素
* 生活ワールドでは例外として1人称視点が使用可能
* 今までのMinecraftの生活スタイルではなく、ゲームの”ハウジング機能”に近い
* 全プレイヤーがアクセス可能な **区画分けされた生活ワールド** を用意
  * プレイヤーが購入した区画は自分の区画（数チャンクレベル）において自由に使用することができる。
  * 地下・上空など高度を問わず自由に使用することができる。
* ゲーム内通貨を使用したアイテムの売買・サービスの売買ができる
  * 従来のMinecraftのようなクラフトは基本不可能
  * アイテムを上手に売買しながら体制を整え、プレイグラウンドに出る

#### ゲーム：ランク・レベル上げ要素
* プレイヤーとしてのランク上げ要素
  * デイリー任務、他プレイヤーとの交流、プレイ時間などに応じてランクが上がる
  * ゲームの進行には基本的に関係なく、一目でプレイヤーがどのくらいゲームをプレイしているかを可視化する数値
* 戦闘・建築・生活の3要素と簡略化されたレベル上げ要素
  * 戦闘レベル
    * 攻撃方法問わず経験値を取得することができる
    * 与えたダメージ、受けたダメージ、武器種等に応じて経験値が変化する
  * 建築レベル
    * 自分の区画で建築（ブロックの設置・破壊）を行った量でレベルが上がる
    * 丸石製造機など無限に使用できる設備ではレベル上げができないように対策
  * 生活レベル
    * ゲーム全体のプレイ時間で少しづつ経験値を取得することができる
    * アイテムを作る、買う、使用するなどでも経験値を取得することができる

### ゲーム開発
#### 開発：コーディング
* Coderを使用したクラウド開発環境
  * vscode-web, VSCode互換ソフトでどこでも何でも開発可能
  * Github簡単にログイン、リポジトリへのアクセスも自動構築
  * テストサーバーも内部で起動するため簡単にプラグイン・スクリプトのテストが可能
  * 必要に応じてVNCリモートデスクトップ環境も提供可
* AIエージェントを使用した高速開発＋機能単位での開発を基本とした開発スタイル
  * Antigravity, Kiro等タスク分け・レビュー要求を行うエージェント内蔵IDEを使用
  * ドキュメントを参照し、チーム全体で統一されたAIエージェント活用が可能
* 絶対的にGithubの専用リポジトリで開発用ドキュメントを管理
  * AIエージェントの`AGENT.md`, `GEMINI.md`等システムプロンプトも共通化
  * AIエージェントが読み込むドキュメントもリポジトリレベルで全体管理を行うことで常に共通のドキュメントを参照しつつ高速な開発が可能

#### 開発：デプロイ
* Cloudflare Tunnel, 外部VPSを使用したセキュアなサーバー公開
* Kubernetesを使用したコンテナ単位でのデプロイ
  * ArgoCDを使用 (CI/CD, IaC)
  * ゲーム
    * Minecraftプロキシ (BungeeCord, Velocity等)
    * Minecraftサーバー (Spigot, Paper, Purpur等)
  * サービス
    * ゲームサーバー状態監視
      * Webサイト
      * DiscordBot経由
    * プロキシ (Nginx等)
    * k8sロードバランサ (Metal-LB等)
  * ストレージ
    * k8s永続ストレージ

#### 開発：その他
* Github Projects, DiscordBotを使用し各開発者の進捗を確認
* Skriptは汎用言語ではないため、専用のコードレビューAIを使用してAIによるコードレビューもしたい